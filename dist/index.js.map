{
  "version": 3,
  "file": "index.js",
  "sourceRoot": "",
  "sources": [
    "index.src.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "# requestAnimationFrame polyfill by Erik MÃ¶ller. fixes from Paul Irish and Tino Zijdel\n# MIT license\n\ndo ->\n  lastTime = 0\n  vendors = [ 'ms', 'moz', 'webkit', 'o' ]\n  x = 0\n  while x < vendors.length and !window.requestAnimationFrame\n    window.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame']\n    window.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame'] or window[vendors[x] + 'CancelRequestAnimationFrame']\n    ++x\n  if !window.requestAnimationFrame\n\n    window.requestAnimationFrame = (callback, element) ->\n      currTime = (new Date).getTime()\n      timeToCall = Math.max(0, 16 - (currTime - lastTime))\n      id = window.setTimeout((->\n        callback currTime + timeToCall\n        return\n      ), timeToCall)\n      lastTime = currTime + timeToCall\n      id\n\n  if !window.cancelAnimationFrame\n\n    window.cancelAnimationFrame = (id) ->\n      clearTimeout id\n      return\n  return\n\ninit = ->\n  canvasEl = document.getElementById 'canvas'\n\n  nxtBtnEl = document.getElementById 'nextFrame'\n  startBtnEl = document.getElementById 'start'\n  stopBtnEl = document.getElementById 'stop'\n\n  textEl = document.getElementById 'textarea'\n  textOriginalEl = document.getElementById 'textOriginal'\n\n  canvasEl.width = 256\n  canvasEl.height = 256\n  ctx = canvasEl.getContext '2d'\n  imageData = ctx.getImageData 0, 0, canvasEl.width, canvasEl.height\n  data = imageData.data\n\n  audioData = new Uint8Array(canvasEl.width*canvasEl.height)\n\n  refreshAutomatic = true\n\n  wwCanvas = new Worker \"worker.js\"\n\n\n\n  sinetone = ->\n    sr = Pico.sampleRate\n    bs = Pico.bufferSize\n    bufferCnt = 0\n\n    (e) ->\n      out = e.buffers\n      i = 0\n      while i < e.bufferSize\n        pos = bs*bufferCnt\n        out[0][i] = audioData[pos+i] / 16\n        out[0][i] = audioData[pos+i] / 16\n        i++\n      if (bufferCnt+1)*bs>audioData.length then bufferCnt = 0\n      else bufferCnt++\n\n\n  cycle = ->\n    wwCanvas.postMessage \"G\" # get image data array\n    if refreshAutomatic then requestAnimationFrame cycle\n\n  wwCanvas.onmessage = (n)->\n    len = n.data.length\n    while len--\n      audioData[len] = n.data[len]\n      pos = len*4\n      wwData = n.data[len]\n      data[pos]  = wwData\n      data[pos+1] = wwData\n      data[pos+2] = wwData\n      data[pos+3] = 255\n    ctx.putImageData imageData, 0, 0\n\n\n\n\n\n  prevTextValue = \"\"\n\n  keyyy = (e)->\n    char = \"\"\n    for charOrig in textOriginalEl.value\n      if charOrig==\"a\" then char += \"&#8592;\"\n      else if charOrig==\"d\" then char += \"&#8594;\"\n      else if charOrig==\"w\" then char += \"&#8593;\"\n      else if charOrig==\"s\" then char += \"&#8595;\"\n\n      else if charOrig==\"r\" then char += \"&#10595;\"\n      else if charOrig==\"f\" then char += \"&#10597;\"\n      else if charOrig==\"y\" then char += \"Y\"\n      else if charOrig==\"x\" then char += \"X\"\n      else if charOrig==\"c\" then char += \"&#8630;\"\n      else if charOrig==\"v\" then char += \"&#8631;\"\n      else if charOrig==\"\\n\" then char += \"<br/>\"\n    textEl.innerHTML = char\n\n    instrRaw = textOriginalEl.value\n    instrRaw = instrRaw.replace(/[^23456789wasdrfyxc\\+\\-\\|\\&\\^]/g, \"\")\n    return if instrRaw.length==0 || prevTextValue == e.target.value\n    prevTextValue = e.target.value\n    wwCanvas.postMessage \"S\"\n    wwCanvas.postMessage instrRaw\n    console.log instrRaw\n    # return false\n\n  textOriginalEl.addEventListener \"keyup\", keyyy\n\n\n\n\n\n\n  nxtBtnEl.addEventListener \"click\", ->\n    refreshAutomatic = false\n    cycle()\n\n  startBtnEl.addEventListener \"click\", ->\n    if refreshAutomatic then return false\n    refreshAutomatic = true\n    cycle()\n\n  stopBtnEl.addEventListener \"click\", ->\n    refreshAutomatic = false\n\n  keyyy {target:textEl}\n  cycle()\n  Pico.play sinetone()\n\nwindow.onload = init\n\nclass Textmode\n  constructor: (textEl)->\n    @el = textEl\n    @initScreen()\n    @welcomeMsg()\n    window.addEventListener 'keydown', @keydown\n    window.addEventListener 'keypress', @keypress\n    requestAnimationFrame @cycle\n  SCREENSIZE: w:40, h:25\n  time: 0 # count every animation frame\n  cursor: x:0, y:0, blink:true\n  keydown: (e)=>\n    if e.keyCode==8 # BACKSPACE\n      e.preventDefault()\n      @delChar()\n      return false\n    if e.ctrlKey && e.shiftKey then @switchCaps()\n    else if e.keyCode==37 then @checkCursor @cursor.x-1, null # LEFT ARROW\n    else if e.keyCode==39 then @checkCursor @cursor.x+1, null # RIGHT ARROW\n    else if e.keyCode==40 then @checkCursor null, @cursor.y+1 # TOP ARROW\n    else if e.keyCode==38 then @checkCursor null, @cursor.y-1 # BOTTOM ARROW\n  keypress: (e)=>\n    if e.keyCode==13 then @getLine() # ENTER\n    else if (e.keyCode||e.charCode)==32 then @putChar '&nbsp;' # SPACE\n    else\n      charCode = if e.keyCode==0 then e.charCode else e.keyCode\n      @putChar String.fromCharCode charCode\n  switchCaps: ->\n    @el.className = if @el.className!='capsMode' then 'capsMode' else ''\n  welcomeMsg: ->\n    @checkCursor(0, 0)\n    @writeDelayed '\\n     **** saylermorph.com v0.1 ****\\n\\n 64k ram system 38911 basic bytes free\\n\\nready.\\n'\n  initScreen: ->\n    for y in [0...@SCREENSIZE.h]\n      rowEl = document.createElement 'ul'\n      for x in [0...@SCREENSIZE.w]\n        cellEl = document.createElement 'li'\n        cellEl.innerHTML = '&nbsp;'\n        rowEl.appendChild cellEl\n      @el.appendChild rowEl\n\n  checkCursor: (x,y)->\n    @getCell().className = ''\n    @cursor.x = x if x?\n    @cursor.y = y if y?\n\n    if @cursor.x==@SCREENSIZE.w\n      @cursor.x = 0\n      @cursor.y++\n    else if @cursor.x==-1\n      @cursor.x = @SCREENSIZE.w-1\n      @cursor.y--\n\n    if @cursor.y==@SCREENSIZE.h\n      @cursor.y -= 1\n      @shiftScreenUp()\n\n    else if @cursor.y==-1\n      @cursor.y = @SCREENSIZE.h-1\n\n    @getCell().className = 'inverted'\n\n  cmdInterpreter: (cmd)->\n    interval = null\n    if cmd.trim().length==0 then return true\n    if cmd.split('clear').length>1\n      @clearScreen()\n    else if cmd.split('list').length>1\n      @writeDelayed '0\\n1\\n2\\n3\\n4\\n5\\nready.\\n'\n    else if cmd.split('reset').length>1\n      @clearScreen()\n      @welcomeMsg()\n    else if cmd.split('help').length>1\n      @writeDelayed '\\n\\ncall 0900-drs-will-do-it\\nready.\\n'\n    else if cmd.split('load').length>1\n      @writeDelayed '\\n\\npress play on tape\\nloading\\nready.\\n'\n    else if cmd.split('run').length>1\n      @clearScreen()\n      @writeDelayed '\n        1. A robot may not injure a human being\\n   or, through inaction, allow a human\n        \\n   being to come to harm.\n        \\n\\n2. A robot must obey the orders given\n        \\n   it by human beings except where such\\n   orders would conflict with the First\\n   Law.\n        \\n\\n3. A robot must protect its own\n        \\n   existence as long as such protection\\n   does not conflict with\\n   the First or Second Laws\n        \\n\\n\\n\\nready.\\n'\n    else @writeDelayed '\\n?syntax error\\nready.\\n'\n    return true\n\n\n  getCell: ->\n    @el.childNodes[@cursor.y].childNodes[@cursor.x]\n\n  getLine: ->\n    lineText = ''\n    for child in @el.childNodes[@cursor.y].childNodes\n      char = child.innerHTML\n      lineText += if char=='&nbsp;' then ' ' else char\n    if @cmdInterpreter lineText.toLowerCase() then @newLine()\n    @checkCursor()\n\n  blinkCursor: ->\n    if @cursor.blink then @getCell().className = 'inverted'\n    else @getCell().className = ''\n    @cursor.blink = !@cursor.blink\n\n  putChar: (char)->\n    @checkCursor null, null\n    @getCell().innerHTML = char\n    @checkCursor @cursor.x+1, null\n\n  delChar: ()->\n    @checkCursor @cursor.x-1, null\n    cell = @getCell()\n    cell.innerHTML = '&nbsp;'\n\n  newLine: ()=>\n    @checkCursor 0, @cursor.y+1\n    @getCell().className = 'inverted'\n\n  clearScreen: ->\n    @getCell().className = ''\n    @cursor = x:0, y:0, blink:false\n    for line in @el.childNodes\n      for cell in line.childNodes\n        cell.innerHTML = '&nbsp;'\n    @getCell().className = 'inverted'\n\n  setColor: ->  null # TODO ???\n\n  shiftScreenUp: ->\n    len = @el.childNodes\n    for child, i in @el.childNodes\n      if i==@el.childNodes.length-1\n        for li in child.childNodes\n          li.innerHTML = \"&nbsp\"\n        return true\n      replacement = @el.childNodes[i+1].innerHTML\n      original = @el.childNodes[i]\n      original.innerHTML = replacement\n\n      #replacement.parentNode.replaceChild replacement, original\n\n\n  textToWriteDelayed: \"\"\n\n  writeDelayed: (text)-> @textToWriteDelayed += text\n\n  nextDelayedText: ()->\n    @write @textToWriteDelayed[0]\n    @textToWriteDelayed = @textToWriteDelayed.substring 1, @textToWriteDelayed.length\n\n  write: (text)-> # TODO implement \\0 - \\f \\! codes \\fore /background foreground and inverted\n    for char in text\n      if char=='\\n' then @newLine()\n      else\n        @putChar if char==' ' then char = '&nbsp;' else char\n\n  cycle: =>\n    if (@time++)%35==0 then @blinkCursor()\n    if (@time)%1==0 && @textToWriteDelayed.length>0 then @nextDelayedText()\n    requestAnimationFrame @cycle\n"
  ]
}